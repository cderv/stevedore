# Without this entry, container_list will fail with a vapply error
# because definitions$Mount$properties$Source$type is missing
- version: ["1.25", "1.29"]
  path: ["definitions", "Mount", "properties", "Source"]
  value:
    type: "string"

- version: ["1.25", "1.36"]
  path: ["paths", "/system/df", "get", "responses", "200", "schema", "properties", "Containers"]
  replace: true
  value:
    $ref: "#/definitions/ContainerSummary"

- version: ["1.29", "1.30"]
  path: ["paths", "/images/load", "post", "responses", "200"]
  value:
    schema:
      type: "object"

# This is backported from the 1.32 spec
- version: ["1.29", "1.31"]
  path: ["definitions", "PortBinding"]
  value:
    type: "object"
    properties:
      HostIp:
        type: "string"
      HostPort:
        type: "string"

- version: ["1.29", "1.31"]
  path: ["definitions", "NetworkConfig", "properties", "Ports"]
  replace: true
  value:
    type: "object"
    additionalProperties:
      type: "array"
      items:
        "$ref": "#/definitions/PortBinding"

- version: ["1.32", "1.33"]
  path: ["definitions", "PeerNode"]
  value:
    type: "object"

- version: ["1.25", "1.36"]
  path: ["paths", "/system/df", "get"]
  value:
    produces: "application/json"

- version: ["1.25", "1.36"]
  path: ["paths", "/containers/{id}/top", "get"]
  value:
    produces: "application/json"

- version: ["1.25", "1.33"]
  path: ["paths", "/containers/{id}/archive", "put", "parameters",
  "@name = inputStream", "schema"]
  value:
    format: "binary"

- version: ["1.34", "1.36"]
  path: ["definitions", "PeerNode"]
  value:
    type: object

- version: ["1.29", "1.29"]
  path: ["definitions", "TaskSpec", "properties", "Resources", "properties", "Reservation"]
  value:
    type: object

- path: ["paths", "/swarm", "get"]
  value:
    produces: "application/json"

- path: ["paths", "/swarm/init", "post"]
  value:
    produces: "application/json"

- path: ["paths", "/swarm/unlockkey", "get"]
  value:
    produces: "application/json"

- path: ["paths", "/nodes", "get"]
  value:
    produces: "application/json"

- path: ["paths", "/nodes/{id}", "get"]
  value:
    produces: "application/json"

- path: ["paths", "/services", "get"]
  value:
    produces: "application/json"

- path: ["paths", "/services/{id}", "get"]
  value:
    produces: "application/json"

- path: ["paths", "/tasks", "get"]
  value:
    produces: "application/json"

- path: ["paths", "/secrets/{id}", "get"]
  value:
    produces: "application/json"

- path: ["paths", "/plugins/privileges", "get"]
  value:
    produces: "application/json"

- path: ["paths", "/plugins/{name}/json", "get"]
  value:
    produces: "application/json"

- path: ["paths", "/plugins/{name}", "delete"]
  value:
    produces: "application/json"

- path: ["definitions", "ServiceSpec"]
  value:
    type: "object"

- path: ["definitions", "TaskSpec", "properties", "Resources", "properties", "Reservation"]
  value:
    type: "object"

# Feature added in 1.30, type annotation added in 1.32
- version: ["1.30", "1.31"]
  path: ["definitions", "SwarmSpec", "properties", "CAConfig", "properties", "ForceRotate"]
  value:
    type: "integer"

# NOTE: debateably belongs in stevedore.yaml, but the spec appears
# wrong so we'll just do this all at once.
- path: ["paths", "/services/{id}/logs", "get"]
  value:
    produces: "application/chunked-string"

- version: ["1.29", "1.36"]
  path: ["paths", "/tasks/{id}/logs", "get"]
  value:
    produces: "application/chunked-string"
