<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Docker Client • stevedore</title>
<!-- jquery --><script src="https://code.jquery.com/jquery-3.1.0.min.js" integrity="sha384-nrOSfDHtoPMzJHjVTdCopGqIqeYETSXhZDFyniQ8ZHcVy08QesyHcnOUpMpqnmWq" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.6.3/css/font-awesome.min.css" rel="stylesheet" integrity="sha384-T8Gy5hrqNKT+hzMclPo118YTQO6cYprQmhrYwIiQ/3axmI1hQomh7Ud2hPOy8SP1" crossorigin="anonymous">
<!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="jquery.sticky-kit.min.js"></script><script src="pkgdown.js"></script><!-- mathjax --><script src="https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-vignette">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">stevedore</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="articles/stevedore.html">Get Started</a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/examples.html">Examples and use-cases</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9">
    

    
    
<div class="contents">
<!-- -*-markdown-*- -->
<div id="stevedore" class="section level1">
<div class="page-header"><h1 class="hasAnchor">
<a href="#stevedore" class="anchor"></a>stevedore</h1></div>

<p>A docker client for R</p>
<div class="figure">
<img src="https://raw.githubusercontent.com/richfitz/stevedore/master/demo/hello.gif" alt="hello world example of stevedore"><p class="caption">hello world example of stevedore</p>
</div>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p><strong>What is docker?</strong> Docker is a platform for “containerising” applications - running them in isolation from one another, removing differences of how they are built, what they are built from, and what resources they need (disk, ports, users, etc). It’s similar conceptually to virtualisation, but much more light weight.</p>
<p><strong>Why would one want to use docker from R?</strong> Whenever you need to control external processes from an R script or package, it might be useful to interact with this process from in containers using docker</p>
<ul>
<li>
<em>package authors</em> might want a clean environment to test their code (similar to travis)</li>
<li>
<em>a developer using an external database</em> in a package or in an analysis script might use docker to create disposable copies of the database, or to create a copy isolated from their production database</li>
<li>
<em>a researcher</em> might use docker to do a reproducible analysis, or preserve the artefacts that were created along with a copy of the environment that created them</li>
</ul>
<p>These are discussed further in the <a href="https://richfitz.github.io/stevedore/articles/examples.html">applications vignette</a></p>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>The main function in the package is <code>docker_client</code>; this will construct an object with which we can talk with the docker server.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">docker &lt;-<span class="st"> </span>stevedore::<span class="kw"><a href="reference/docker_client.html">docker_client</a></span>()
docker</code></pre></div>
<pre><code>## &lt;docker_client&gt;
##   config: Manage docker swarm configs
##   container: Work with docker containers
##   image: Work with docker images
##   network: Work with docker networks
##   node: Manage docker swarm nodes
##   plugin: Work with docker plugins
##   secret: Manage docker swarm secrets
##   service: Work with docker services
##   swarm: Manage the docker swarm
##   task: Work with docker tasks
##   volume: Work with docker volumes
##   types: Methods for building complex docker types
##   api_version()
##   df()
##   events(since = NULL, until = NULL, filters = NULL)
##   help(help_type = getOption("help_type"))
##   info()
##   login(username = NULL, password = NULL, email = NULL,
##       serveraddress = NULL)
##   ping()
##   version()</code></pre>
<p>With this you can run containers:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">docker$container$<span class="kw">run</span>(<span class="st">"alpine:3.1"</span>, <span class="kw">c</span>(<span class="st">"echo"</span>, <span class="st">"hello world"</span>))</code></pre></div>
<pre><code>## O&gt; hello world</code></pre>
<pre><code>## &lt;docker_run_output&gt;
##   $container:
##     &lt;docker_container&gt;
##       id: 332fe1a820f47afc701572e0e8ed3cd93ae1270361da174fd168c25f2e8bfc60
##       name: unruffled_ride
## 
##   $logs:
##     O&gt; hello world</code></pre>
<p>Or run containers in the background</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">docker$container$<span class="kw">run</span>(<span class="st">"bfirsh/reticulate-splines"</span>, <span class="dt">detach =</span> <span class="ot">TRUE</span>)</code></pre></div>
<pre><code>## &lt;docker_container&gt;
##   commit(repo = NULL, tag = NULL, author = NULL, changes = NULL,
##       comment = NULL, pause = NULL, hostname = NULL, domainname = NULL,
##       user = NULL, attach_stdin = NULL, attach_stdout = NULL,
##       attach_stderr = NULL, exposed_ports = NULL, tty = NULL,
##       open_stdin = NULL, stdin_once = NULL, env = NULL, cmd = NULL,
##       healthcheck = NULL, args_escaped = NULL, image = NULL,
##       volumes = NULL, working_dir = NULL, entrypoint = NULL,
##       network_disabled = NULL, mac_address = NULL, on_build = NULL,
##       labels = NULL, stop_signal = NULL, stop_timeout = NULL,
##       shell = NULL)
##   diff()
##   exec(cmd, stdin = NULL, stdout = TRUE, stderr = TRUE,
##       detach_keys = NULL, tty = NULL, env = NULL, privileged = NULL,
##       user = NULL)
##   export()
##   get_archive(path, dest)
##   help(help_type = getOption("help_type"))
##   id()
##   image()
##   inspect(reload = TRUE)
##   kill(signal = NULL)
##   labels(reload = TRUE)
##   logs(follow = NULL, stdout = TRUE, stderr = TRUE, since = NULL,
##       timestamps = NULL, tail = NULL, stream = stdout())
##   name()
##   path_stat(path)
##   pause()
##   ports(reload = TRUE)
##   put_archive(src, path, no_overwrite_dir_non_dir = NULL)
##   reload()
##   remove(delete_volumes = NULL, force = NULL, link = NULL)
##   rename(name)
##   resize(h = NULL, w = NULL)
##   restart(t = NULL)
##   start(detach_keys = NULL)
##   stats()
##   status(reload = TRUE)
##   stop(t = NULL)
##   top(ps_args = NULL)
##   unpause()
##   update(cpu_shares = NULL, memory = NULL, cgroup_parent = NULL,
##       blkio_weight = NULL, blkio_weight_device = NULL,
##       blkio_device_read_bps = NULL, blkio_device_write_bps = NULL,
##       blkio_device_read_iops = NULL, blkio_device_write_iops = NULL,
##       cpu_period = NULL, cpu_quota = NULL, cpu_realtime_period = NULL,
##       cpu_realtime_runtime = NULL, cpuset_cpus = NULL,
##       cpuset_mems = NULL, devices = NULL, device_cgroup_rules = NULL,
##       disk_quota = NULL, kernel_memory = NULL,
##       memory_reservation = NULL, memory_swap = NULL,
##       memory_swappiness = NULL, nano_cpus = NULL,
##       oom_kill_disable = NULL, pids_limit = NULL, ulimits = NULL,
##       cpu_count = NULL, cpu_percent = NULL, io_maximum_iops = NULL,
##       io_maximum_bandwidth = NULL, restart_policy = NULL)
##   wait()</code></pre>
<p>You can manage containers</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">docker$container$<span class="kw">list</span>()</code></pre></div>
<pre><code>##                                                                 id
## 1 93c0819957bcf1265ee808bd7584ce243f1b52e6ac24d9c6e9d43037762614a7
##          names
## 1 modest_nobel
##                                                                     image
## 1 sha256:b1666055931f332541bda7c425e624764de96c85177a61a0b49238a42b80b7f9
##                                                                  image_id
## 1 sha256:b1666055931f332541bda7c425e624764de96c85177a61a0b49238a42b80b7f9
##                 command    created        ports size_rw size_root_fs
## 1 /usr/local/bin/run.sh 1523909556 characte....      NA           NA
##   labels   state                status host_config network_settings
## 1        running Up Less than a second     default     list(bri....
##         mounts         name
## 1 characte.... modest_nobel</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">id &lt;-<span class="st"> </span>docker$container$<span class="kw">list</span>(<span class="dt">limit =</span> 1L)$id
container &lt;-<span class="st"> </span>docker$container$<span class="kw">get</span>(id)
container</code></pre></div>
<pre><code>## &lt;docker_container&gt;
##   commit(repo = NULL, tag = NULL, author = NULL, changes = NULL,
##       comment = NULL, pause = NULL, hostname = NULL, domainname = NULL,
##       user = NULL, attach_stdin = NULL, attach_stdout = NULL,
##       attach_stderr = NULL, exposed_ports = NULL, tty = NULL,
##       open_stdin = NULL, stdin_once = NULL, env = NULL, cmd = NULL,
##       healthcheck = NULL, args_escaped = NULL, image = NULL,
##       volumes = NULL, working_dir = NULL, entrypoint = NULL,
##       network_disabled = NULL, mac_address = NULL, on_build = NULL,
##       labels = NULL, stop_signal = NULL, stop_timeout = NULL,
##       shell = NULL)
##   diff()
##   exec(cmd, stdin = NULL, stdout = TRUE, stderr = TRUE,
##       detach_keys = NULL, tty = NULL, env = NULL, privileged = NULL,
##       user = NULL)
##   export()
##   get_archive(path, dest)
##   help(help_type = getOption("help_type"))
##   id()
##   image()
##   inspect(reload = TRUE)
##   kill(signal = NULL)
##   labels(reload = TRUE)
##   logs(follow = NULL, stdout = TRUE, stderr = TRUE, since = NULL,
##       timestamps = NULL, tail = NULL, stream = stdout())
##   name()
##   path_stat(path)
##   pause()
##   ports(reload = TRUE)
##   put_archive(src, path, no_overwrite_dir_non_dir = NULL)
##   reload()
##   remove(delete_volumes = NULL, force = NULL, link = NULL)
##   rename(name)
##   resize(h = NULL, w = NULL)
##   restart(t = NULL)
##   start(detach_keys = NULL)
##   stats()
##   status(reload = TRUE)
##   stop(t = NULL)
##   top(ps_args = NULL)
##   unpause()
##   update(cpu_shares = NULL, memory = NULL, cgroup_parent = NULL,
##       blkio_weight = NULL, blkio_weight_device = NULL,
##       blkio_device_read_bps = NULL, blkio_device_write_bps = NULL,
##       blkio_device_read_iops = NULL, blkio_device_write_iops = NULL,
##       cpu_period = NULL, cpu_quota = NULL, cpu_realtime_period = NULL,
##       cpu_realtime_runtime = NULL, cpuset_cpus = NULL,
##       cpuset_mems = NULL, devices = NULL, device_cgroup_rules = NULL,
##       disk_quota = NULL, kernel_memory = NULL,
##       memory_reservation = NULL, memory_swap = NULL,
##       memory_swappiness = NULL, nano_cpus = NULL,
##       oom_kill_disable = NULL, pids_limit = NULL, ulimits = NULL,
##       cpu_count = NULL, cpu_percent = NULL, io_maximum_iops = NULL,
##       io_maximum_bandwidth = NULL, restart_policy = NULL)
##   wait()</code></pre>
<p>And control containers</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">container$<span class="kw">inspect</span>()$config$image</code></pre></div>
<pre><code>## [1] "sha256:b1666055931f332541bda7c425e624764de96c85177a61a0b49238a42b80b7f9"</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">container$<span class="kw">logs</span>()</code></pre></div>
<pre><code>## O&gt; Reticulating spline 1...</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">container$<span class="kw">stop</span>(<span class="dt">t =</span> <span class="dv">0</span>)</code></pre></div>
<pre><code>## NULL</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">container$<span class="kw">remove</span>()</code></pre></div>
<pre><code>## NULL</code></pre>
<p>And manage images</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(docker$image$<span class="kw">list</span>())</code></pre></div>
<pre><code>##                                                                        id
## 1 sha256:50f3ab513c06ee645398374b9b3624d49273868519d29524d709b6715d38ad7a
## 2 sha256:5acda2128c1ce79bab760171b95b9df973dc71902445b3f2e64ccd7ee395f48e
## 3 sha256:92203437252f483e34208e6176bf745b123b371f3bfacc0877e97fa113fd2062
## 4 sha256:cdc22b086fa57f4c30c002d4f24264ba33e8ffa150fdaa7e9796c9693125bdcc
## 5 sha256:806d8354083c21205f31a3f41054d03801006128ee8d59cb1959382d463a9cd9
## 6 sha256:e38bc07ac18ee64e6d59cf2eafcdddf9cec2364dfe129fe0af75f1b0194e0c96
##                                                                 parent_id
## 1 sha256:dfb127bd840ede085e8c2e6da9e562a0ba82743f0e126f0f4fd72bd35613af84
## 2 sha256:3fa9d64aa1d09b6e971a00fbfd87200b92ad7cca09e565c2a4f7a26f6953dc31
## 3 sha256:838ab5e2b5a0956cc075f93673017409d477f3bd479453acb88330be391470e0
## 4 sha256:fd8bead4376d493f311469bc7675e8e8396168b6932aa03c8dce5403cd21b079
## 5 sha256:2c3f77b401746affac6b1c54fd7fd16da63299aec61b48aaa9f72c2420f32364
## 6                                                                        
##      repo_tags repo_digests    created    size shared_size virtual_size
## 1 &lt;none&gt;:&lt;.... &lt;none&gt;@&lt;.... 1523909157 4148087          -1      4148087
## 2 &lt;none&gt;:&lt;.... &lt;none&gt;@&lt;.... 1523903249 4148087          -1      4148087
## 3 richfitz....              1523903248 4147914          -1      4147914
## 4 richfitz....              1523903246 4148020          -1      4148020
## 5 richfitz....              1523903244 5496609          -1      5496609
## 6 hello-wo.... hello-wo.... 1523470309    1848          -1         1848
##   labels containers
## 1  0.0.1         -1
## 2  0.0.1         -1
## 3  0.0.1         -1
## 4                -1
## 5                -1
## 6                -1</code></pre>
<p>Some of these functions have many arguments, but <code>stevedore</code> includes help inline:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">docker$container$create</code></pre></div>
<pre><code>## function(image, cmd = NULL, hostname = NULL, domainname = NULL,
##     user = NULL, attach_stdin = NULL, attach_stdout = NULL,
##     attach_stderr = NULL, ports = NULL, tty = NULL, open_stdin = NULL,
##     stdin_once = NULL, env = NULL, health_check = NULL,
##     args_escaped = NULL, volumes = NULL, working_dir = NULL,
##     entrypoint = NULL, network_disabled = NULL, mac_address = NULL,
##     on_build = NULL, labels = NULL, stop_signal = NULL,
##     stop_timeout = NULL, shell = NULL, host_config = NULL,
##     network = NULL, name = NULL)
## ----------------------------------------------------------------------
## Create a container. Similar to the cli command `docker create` or
##   `docker container create`.
## ----------------------------------------------------------------------
##   image: The name of the image to use when creating the container
##   cmd: Command to run specified as a string or an array of
##         strings.
##   hostname: The hostname to use for the container, as a valid RFC
##         1123 hostname.
##   domainname: The domain name to use for the container.
##   user: The user that commands are run as inside the container.
##   attach_stdin: Whether to attach to `stdin`.
##   attach_stdout: Whether to attach to `stdout`.
##   attach_stderr: Whether to attach to `stderr`.
##   ports: A character vector of port mappings between the container
##         and host, in (1) the form `&lt;host&gt;:&lt;container&gt;` (e.g.,
##         `10080:80` to map the container's port 80 to the host's
##         port 10080), (2) the form `&lt;port&gt;` as shorthand for
##         `&lt;port&gt;:&lt;port&gt;`, or (3) a single logical value `TRUE`
##         indicating to map all container ports to random available
##         ports on the host.  You can use the `$ports()` method in
##         the `?docker_container` object to query the port mapping
##         of a running container.
##   tty: Attach standard streams to a TTY, including `stdin` if it
##         is not closed.
##   open_stdin: Open `stdin`
##   stdin_once: Close `stdin` after one attached client disconnects
##   env: A list of environment variables to set inside the container
##         in the form `["VAR=value", ...]`. A variable without `=`
##         is removed from the environment, rather than to have an
##         empty value.
##   health_check: A test to perform to check that the container is
##         healthy. Construct with `$types$health_config()`
##   args_escaped: Command is already escaped (Windows only)
##   volumes: A character vector of mappings of mount points on the
##         host (or in volumes) to paths on the container.  Each
##         element must be of the form
##         `&lt;path_host&gt;:&lt;path_container&gt;`, possibly followed by `:ro`
##         for read-only mappings (i.e., the same syntax as the
##         docker command line client).
##         `?docker_volume` objects have a `$map` method to help with
##         generating these paths for volume mappings.
##   working_dir: The working directory for commands to run in.
##   entrypoint: The entry point for the container as a string or an
##         array of strings.
## 
##         If the array consists of exactly one empty string (`[""]`)
##         then the entry point is reset to system default (i.e., the
##         entry point used by docker when there is no `ENTRYPOINT`
##         instruction in the `Dockerfile`).
##   network_disabled: Disable networking for the container.
##   mac_address: MAC address of the container.
##   on_build: `ONBUILD` metadata that were defined in the image's
##         `Dockerfile`.
##   labels: User-defined key/value metadata.
##   stop_signal: Signal to stop a container as a string or unsigned
##         integer.
##   stop_timeout: Timeout to stop a container in seconds.
##   shell: Shell for when `RUN`, `CMD`, and `ENTRYPOINT` uses a
##         shell.
##   host_config: Container configuration that depends on the host we
##         are running on
##   network: This container's networking configuration.
##   name: Assign the specified name to the container. Must match
##         `/?[a-zA-Z0-9_-]+`.</code></pre>
<p>as well as via an <code>help()</code> method on each object (e.g., <code>docker$help()</code>, <code>docker$container$help()</code>) which will display help for the API version that you are using.</p>
</div>
<div id="approach" class="section level2">
<h2 class="hasAnchor">
<a href="#approach" class="anchor"></a>Approach</h2>
<p>Docker publishes a <a href="https://docs.docker.com/engine/api/v1.29">machine-readable API specification</a>. Rather than manually write wrappers that fit the output docker gives, <code>stevedore</code> <em>generates</em> an interface directly from the spefification. Currently <code>stevedore</code> supports docker API versions 1.25 to 1.37 (defaulting to 1.29).</p>
<p>This approach means that the output will be type-stable - there is no inference on what to return based on what the server chooses to return. With a given API version, the same fields will always be returned. Some of this information is very rich, for example, for the backgrounded container above:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">container$<span class="kw">inspect</span>(<span class="dt">reload =</span> <span class="ot">FALSE</span>)</code></pre></div>
<pre><code>## $id
## [1] "93c0819957bcf1265ee808bd7584ce243f1b52e6ac24d9c6e9d43037762614a7"
## 
## $created
## [1] "2018-04-16T20:12:36.3730761Z"
## 
## $path
## [1] "/usr/local/bin/run.sh"
## 
## $args
## character(0)
## 
## $state
## $state$status
## [1] "running"
## 
## $state$running
## [1] TRUE
## 
## $state$paused
## [1] FALSE
## 
## $state$restarting
## [1] FALSE
## 
## $state$oom_killed
## [1] FALSE
## 
## $state$dead
## [1] FALSE
## 
## $state$pid
## [1] 31966
## 
## $state$exit_code
## [1] 0
## 
## $state$error
## [1] ""
## 
## $state$started_at
## [1] "2018-04-16T20:12:36.9270635Z"
## 
## $state$finished_at
## [1] "0001-01-01T00:00:00Z"
## 
## 
## $image
## [1] "sha256:b1666055931f332541bda7c425e624764de96c85177a61a0b49238a42b80b7f9"
## 
## $resolv_conf_path
## [1] "/var/lib/docker/containers/93c0819957bcf1265ee808bd7584ce243f1b52e6ac24d9c6e9d43037762614a7/resolv.conf"
## 
## $hostname_path
## [1] "/var/lib/docker/containers/93c0819957bcf1265ee808bd7584ce243f1b52e6ac24d9c6e9d43037762614a7/hostname"
## 
## $hosts_path
## [1] "/var/lib/docker/containers/93c0819957bcf1265ee808bd7584ce243f1b52e6ac24d9c6e9d43037762614a7/hosts"
## 
## $log_path
## [1] "/var/lib/docker/containers/93c0819957bcf1265ee808bd7584ce243f1b52e6ac24d9c6e9d43037762614a7/93c0819957bcf1265ee808bd7584ce243f1b52e6ac24d9c6e9d43037762614a7-json.log"
## 
## $node
## NULL
## 
## $name
## [1] "/modest_nobel"
## 
## $restart_count
## [1] 0
## 
## $driver
## [1] "overlay2"
## 
## $mount_label
## [1] ""
## 
## $process_label
## [1] ""
## 
## $app_armor_profile
## [1] ""
## 
## $exec_ids
## [1] NA
## 
## $host_config
## $host_config$cpu_shares
## [1] 0
## 
## $host_config$memory
## [1] 0
## 
## $host_config$cgroup_parent
## [1] ""
## 
## $host_config$blkio_weight
## [1] 0
## 
## $host_config$blkio_weight_device
## [1] path   weight
## &lt;0 rows&gt; (or 0-length row.names)
## 
## $host_config$blkio_device_read_bps
## [1] path rate
## &lt;0 rows&gt; (or 0-length row.names)
## 
## $host_config$blkio_device_write_bps
## [1] path rate
## &lt;0 rows&gt; (or 0-length row.names)
## 
## $host_config$blkio_device_read_iops
## [1] path rate
## &lt;0 rows&gt; (or 0-length row.names)
## 
## $host_config$blkio_device_write_iops
## [1] path rate
## &lt;0 rows&gt; (or 0-length row.names)
## 
## $host_config$cpu_period
## [1] 0
## 
## $host_config$cpu_quota
## [1] 0
## 
## $host_config$cpu_realtime_period
## [1] 0
## 
## $host_config$cpu_realtime_runtime
## [1] 0
## 
## $host_config$cpuset_cpus
## [1] ""
## 
## $host_config$cpuset_mems
## [1] ""
## 
## $host_config$devices
## [1] path_on_host       path_in_container  cgroup_permissions
## &lt;0 rows&gt; (or 0-length row.names)
## 
## $host_config$device_cgroup_rules
## character(0)
## 
## $host_config$disk_quota
## [1] 0
## 
## $host_config$kernel_memory
## [1] 0
## 
## $host_config$memory_reservation
## [1] 0
## 
## $host_config$memory_swap
## [1] 0
## 
## $host_config$memory_swappiness
## [1] NA
## 
## $host_config$nano_cpus
## [1] NA
## 
## $host_config$oom_kill_disable
## [1] FALSE
## 
## $host_config$pids_limit
## [1] 0
## 
## $host_config$ulimits
## [1] name soft hard
## &lt;0 rows&gt; (or 0-length row.names)
## 
## $host_config$cpu_count
## [1] 0
## 
## $host_config$cpu_percent
## [1] 0
## 
## $host_config$io_maximum_iops
## [1] 0
## 
## $host_config$io_maximum_bandwidth
## [1] 0
## 
## $host_config$binds
## character(0)
## 
## $host_config$container_idfile
## [1] ""
## 
## $host_config$log_config
## $host_config$log_config$type
## [1] "json-file"
## 
## $host_config$log_config$config
## character(0)
## 
## 
## $host_config$network_mode
## [1] "default"
## 
## $host_config$port_bindings
## NULL
## 
## $host_config$restart_policy
## $host_config$restart_policy$name
## [1] ""
## 
## $host_config$restart_policy$maximum_retry_count
## [1] 0
## 
## 
## $host_config$auto_remove
## [1] FALSE
## 
## $host_config$volume_driver
## [1] ""
## 
## $host_config$volumes_from
## character(0)
## 
## $host_config$mounts
## [1] target         source         type           read_only     
## [5] consistency    bind_options   volume_options tmpfs_options 
## &lt;0 rows&gt; (or 0-length row.names)
## 
## $host_config$cap_add
## character(0)
## 
## $host_config$cap_drop
## character(0)
## 
## $host_config$dns
## character(0)
## 
## $host_config$dns_options
## character(0)
## 
## $host_config$dns_search
## character(0)
## 
## $host_config$extra_hosts
## character(0)
## 
## $host_config$group_add
## character(0)
## 
## $host_config$ipc_mode
## [1] "shareable"
## 
## $host_config$cgroup
## [1] ""
## 
## $host_config$links
## character(0)
## 
## $host_config$oom_score_adj
## [1] 0
## 
## $host_config$pid_mode
## [1] ""
## 
## $host_config$privileged
## [1] FALSE
## 
## $host_config$publish_all_ports
## [1] FALSE
## 
## $host_config$readonly_rootfs
## [1] FALSE
## 
## $host_config$security_opt
## character(0)
## 
## $host_config$storage_opt
## NULL
## 
## $host_config$tmpfs
## NULL
## 
## $host_config$uts_mode
## [1] ""
## 
## $host_config$userns_mode
## [1] ""
## 
## $host_config$shm_size
## [1] 67108864
## 
## $host_config$sysctls
## NULL
## 
## $host_config$runtime
## [1] "runc"
## 
## $host_config$console_size
## [1] 0 0
## 
## $host_config$isolation
## [1] ""
## 
## 
## $graph_driver
## $graph_driver$name
## [1] "overlay2"
## 
## $graph_driver$data
##                                                                                                                                                                                                                                                                                                                                                                                          lower_dir 
## "/var/lib/docker/overlay2/3248afa90531e0b1417dbd2082fe2f2b45e8f45c79554e4732203ead949da5dd-init/diff:/var/lib/docker/overlay2/77cdc2da69d8f65ded5c4351c5ea3b95aab5e887f30b0345121ae9b44b54af98/diff:/var/lib/docker/overlay2/61797179126c3628eabe9f686d2404e75903024a7c585bf733cba7515d689e9f/diff:/var/lib/docker/overlay2/1d21be0bce813352b9211279ad029a021d46e8b05efb027861c146bc65d5f87b/diff" 
##                                                                                                                                                                                                                                                                                                                                                                                         merged_dir 
##                                                                                                                                                                                                                                                                                                 "/var/lib/docker/overlay2/3248afa90531e0b1417dbd2082fe2f2b45e8f45c79554e4732203ead949da5dd/merged" 
##                                                                                                                                                                                                                                                                                                                                                                                          upper_dir 
##                                                                                                                                                                                                                                                                                                   "/var/lib/docker/overlay2/3248afa90531e0b1417dbd2082fe2f2b45e8f45c79554e4732203ead949da5dd/diff" 
##                                                                                                                                                                                                                                                                                                                                                                                           work_dir 
##                                                                                                                                                                                                                                                                                                   "/var/lib/docker/overlay2/3248afa90531e0b1417dbd2082fe2f2b45e8f45c79554e4732203ead949da5dd/work" 
## 
## 
## $size_rw
## [1] NA
## 
## $size_root_fs
## [1] NA
## 
## $mounts
## [1] type        name        source      destination driver      mode       
## [7] rw          propagation
## &lt;0 rows&gt; (or 0-length row.names)
## 
## $config
## $config$hostname
## [1] "93c0819957bc"
## 
## $config$domainname
## [1] ""
## 
## $config$user
## [1] ""
## 
## $config$attach_stdin
## [1] FALSE
## 
## $config$attach_stdout
## [1] FALSE
## 
## $config$attach_stderr
## [1] FALSE
## 
## $config$exposed_ports
## NULL
## 
## $config$tty
## [1] FALSE
## 
## $config$open_stdin
## [1] FALSE
## 
## $config$stdin_once
## [1] FALSE
## 
## $config$env
## [1] "PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin"
## 
## $config$cmd
## [1] "/usr/local/bin/run.sh"
## 
## $config$healthcheck
## NULL
## 
## $config$args_escaped
## [1] TRUE
## 
## $config$image
## [1] "sha256:b1666055931f332541bda7c425e624764de96c85177a61a0b49238a42b80b7f9"
## 
## $config$volumes
## NULL
## 
## $config$working_dir
## [1] ""
## 
## $config$entrypoint
## character(0)
## 
## $config$network_disabled
## [1] NA
## 
## $config$mac_address
## [1] NA
## 
## $config$on_build
## character(0)
## 
## $config$labels
## character(0)
## 
## $config$stop_signal
## [1] NA
## 
## $config$stop_timeout
## [1] NA
## 
## $config$shell
## character(0)
## 
## 
## $network_settings
## $network_settings$bridge
## [1] ""
## 
## $network_settings$gateway
## [1] "172.17.0.1"
## 
## $network_settings$address
## [1] NA
## 
## $network_settings$ip_prefix_len
## [1] 16
## 
## $network_settings$mac_address
## [1] "02:42:ac:11:00:02"
## 
## $network_settings$port_mapping
## [1] NA
## 
## $network_settings$ports
## list()</code></pre>
</div>
<div id="windows-support" class="section level2">
<h2 class="hasAnchor">
<a href="#windows-support" class="anchor"></a>Windows support</h2>
<p>The support for windows is not as comprehensive as for other platforms (but I’m not sure how common using docker is on windows yet). The reason for this is that <a href="https://cran.r-project.org/package=curl"><code>curl</code></a> (and the underlying <code>libcurl</code> library) do not support communicating over “named pipes” which is how docker works on windows. There is partial support for this in the package using the package <a href="http://github.com/richfitz/httppipe"><code>httppipe</code></a>.</p>
<div id="installation" class="section level3">
<h3 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h3>
<p>You will need a python installation (both python2 and python3 should work), along with <a href="https://cran.r-project.org/package=reticulate"><code>reticulate</code></a>. Whatever python you use needs to be able to find the python packages <code>requests</code>, <code>six</code> and <code>pipywin32</code>. You can test if everything is working by running</p>
<pre><code><a href="http://www.rdocumentation.org/packages/httppipe/topics/httppipe_available">httppipe::httppipe_available(verbose = TRUE)</a></code></pre>
<p>which will return <code>TRUE</code> if everything is OK, and otherwise print some information about errors loading the package. In the case of error consult the reticulate documentation (<code><a href="https://cran.rstudio.com/web/packages/reticulate/vignettes/versions.html">vignette("versions", package = "reticulate")</a></code> will be especially useful). Improvements to installation documentation and process are welcome!</p>
</div>
<div id="limitations" class="section level3">
<h3 class="hasAnchor">
<a href="#limitations" class="anchor"></a>Limitations</h3>
<p>The primary limitation of the <code>httppipe</code> interface is that streaming connections are not supported. This affects the following methods</p>
<ul>
<li>container logs with <code>follow = TRUE</code>: completely unsupported</li>
<li>container run - works completely with <code>detach = TRUE</code>, and with <code>detach = FALSE</code> works but prints output only at the end (not streaming output)</li>
<li>image build - works but information printed only at end of build rather than streaming</li>
<li>image pull - works but information printed only at end of pull</li>
<li>exec start - works but information printed only at end of execution</li>
</ul>
</div>
</div>
<div id="roadmap" class="section level2">
<h2 class="hasAnchor">
<a href="#roadmap" class="anchor"></a>Roadmap</h2>
<p>There is still a lot of work to do here:</p>
<ul>
<li>windows support needs work (see above for details)</li>
<li>unix non-socket (tcp) access, including TLS. Setting it up is not too bad but testing it securely is a pain.</li>
<li>endpoints that require http hijacking are not fully supported (i.e., attach) but the foundations are there to support this - stdin is likely to be a major hassle though and I’m not sure if it’s possible from within R’s REPL. The websockets approach might be better but stands very little chance of working on windows.</li>
<li>endpoints that require tar input and output (equivalents of <code>docker cp</code> especially) need major work</li>
</ul>
</div>
<div id="development-and-testing" class="section level2">
<h2 class="hasAnchor">
<a href="#development-and-testing" class="anchor"></a>Development and testing</h2>
<p>See the <a href="development.md">development guide</a> if you want to get started developing <code>stevedore</code> - it provides pointers to the core objects.</p>
</div>
<div id="installation-1" class="section level2">
<h2 class="hasAnchor">
<a href="#installation-1" class="anchor"></a>Installation</h2>
<p>Currently, <code>stevedore</code> is not on CRAN, but can be installed directly from GitHub using devtools</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">"richfitz/stevedore"</span>, <span class="dt">upgrade_dependencies =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>On windows you will also need</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">devtools::<span class="kw">install_github</span>(<span class="st">"richfitz/httppipe"</span>, <span class="dt">upgrade_dependencies =</span> <span class="ot">FALSE</span>)</code></pre></div>
<p>(see <a href="#windows-support">above</a>).</p>
<p>Once installed, find out if everything is set up to use docker by running</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">stevedore::<span class="kw"><a href="reference/docker_available.html">docker_available</a></span>()</code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="licence" class="section level2">
<h2 class="hasAnchor">
<a href="#licence" class="anchor"></a>Licence</h2>
<p>MIT © <a href="https://github.com/richfitz">Rich FitzJohn</a>.</p>
<p>Please note that this project is released with a <a href="CONDUCT.md">Contributor Code of Conduct</a>. By participating in this project you agree to abide by its terms.</p>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2 class="hasAnchor">
<a href="#sidebar" class="anchor"></a>License</h2>
<p><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE.html">LICENSE</a></p>
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Rich FitzJohn <br><small class="roles"> Author, maintainer </small> </li>
</ul>
<h2>Dev status</h2>
<ul class="list-unstyled">
<li><a href="http://www.repostatus.org/#wip"><img src="http://www.repostatus.org/badges/latest/wip.svg" alt="Project Status: WIP - Initial development is in progress, but there has not yet been a stable, usable release suitable for the public."></a></li>
<li><a href="https://travis-ci.org/richfitz/stevedore"><img src="https://travis-ci.org/richfitz/stevedore.svg?branch=master" alt="Travis-CI Build Status"></a></li>
<li><a href="https://codecov.io/github/richfitz/stevedore?branch=master"><img src="https://codecov.io/github/richfitz/stevedore/coverage.svg?branch=master" alt="codecov.io"></a></li>
</ul>
</div>

</div>


      <footer><div class="copyright">
  <p>Developed by Rich FitzJohn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="http://hadley.github.io/pkgdown/">pkgdown</a>.</p>
</div>

      </footer>
</div>

  </body>
</html>
